<cdk-tree
  class="tree"
  [dataSource]="dataSource"
  [treeControl]="treeControl"
  cdkDropListGroup>
  <cdk-nested-tree-node *cdkTreeNodeDef="let node" class="tree-node">
    <div class="tree-node-container">
      <div cdkDropList>
        <div
          cdkDrag
          (cdkDragStarted)="dragging = true"
          (cdkDragReleased)="dragging = false">
          <div class="tree-node-content-container">
            <div class="tree-node-expand-container"></div>
            <div class="tree-node-icon-container">
              <fa-icon [icon]="faBook" [attr.aria-hidden]="false"></fa-icon>
            </div>
            <div class="tree-node-content">
              {{ node.title }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </cdk-nested-tree-node>

  <cdk-nested-tree-node
    *cdkTreeNodeDef="let node; when: hasChild"
    class="tree-node">
    <div class="tree-node-container">
      <div
        cdkDropList
        class="tree-node-drop-zone"
        [class.hide]="!dragging"></div>
      <div cdkDropList class="test">
        <div cdkDrag>
          <div class="tree-node-content-container">
            <div class="tree-node-expand-container">
              <button
                class="tree-node-expand"
                cdkTreeNodeToggle
                [attr.aria-label]="'Toggle ' + node.title">
                <fa-icon
                  [icon]="
                    treeControl.isExpanded(node)
                      ? faChevronDown
                      : faChevronRight
                  "
                  size="xs"
                  [attr.aria-hidden]="false"></fa-icon>
              </button>
            </div>
            <div class="tree-node-icon-container">
              <fa-icon [icon]="faBook" [attr.aria-hidden]="false"></fa-icon>
            </div>
            <div class="tree-node-content">
              {{ node.title }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <div [class.tree-node-invisible]="!treeControl.isExpanded(node)">
      <ng-container cdkTreeNodeOutlet></ng-container>
    </div>
  </cdk-nested-tree-node>
</cdk-tree>
